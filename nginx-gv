user www-data www-data;
worker_processes  4;
events {
    worker_connections  1024;
}
http {
	passenger_root /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.11;
    passenger_ruby /usr/local/bin/ruby;
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    #different
    tcp_nopush      on; 
    #tcp_nodelay     off;
    keepalive_timeout  65;
    gzip  on;
    gzip_comp_level 2;
    gzip_proxied any;
    gzip_types      text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript;
    include /opt/nginx/sites-enabled/*;
}
mkdir /opt/nginx/sites-available /opt/nginx/sites-enabled
echo '
server  {
            listen       80;
            server_name  localhost;
            location /  {
                    root   html;
                    index  index.php index.html index.htm;
       			   }
            # redirect server error pages to the static page /50x.html
            error_page   500 502 503 504  /50x.html;
            location = /50x.html
            		   {
            			root   html;
            		   }
           	passenger_enabled on;
		}
' > /opt/nginx/sites-available/default
ln -s /opt/nginx/sites-available/default /opt/nginx/sites-enabled/default